# 配置归档存储
EnOS支持对设备采集原始数据和流式计算处理之后的数据进行归档存储，提供灵活的存储配置方式，降低数据存储的成本。
## 新建归档存储策略
对设备采集数据或计算数据进行归档存储，需为设备测点创建归档存储策略。

1. 登录EnOS平台，进入**控制台**，选择**存储策略 > 归档存储**。
2. 点击**新建策略**，完成归档存储策略的详细配置。

.. note:: 单个组织内最多可创建5条归档存储策略。

### 基础信息

填写存储策略的基本信息：

1. 输入 **策略名称**，支持中文、英文大小写字母、数字、和下划线，并且不能超过50个字符。
2. 输入策略 **描述**，不能超过100个字符。

### 存储配置

填写存储数据的详细配置信息，包括配置存储资源、设置存储文件属性等。

1. 选择 **资源类型**，指定同步归档文件的目标存储系统（目前仅支持Blob）。
2. 从 **存储资源** 下拉菜单中，选择已通过[外部源连接](/docs/offline-data/zh_CN/2.0.8/data_source/index.html)注册的数据源。
3. 输入归档数据在存储系统中的 **存储路径**，路径必须以"/"开始和结尾，并选择存储路径根目录的时间分区格式。对时间分区格式的详细介绍，参见[存储路径分区参数](../reference/archive_storage)。
4. 选择按事件时间或系统时间生成目录，对按不同时间生成目录的详细介绍，参见[数据归档方式](../reference/archive_storage)。
5. 输入归档 **文件名称**，支持英文大小写字母、数字、和下划线，并且不能超过50个字符。文件生成时，系统将自动在文件名后加上"\_UTC"时间戳后缀。
6. 选择 **文件类型**，目前支持TEXTFILE格式（.csv）。
7. 选择归档文件 **编码格式**，默认格式为UTF-8。
8. 选择 **列分隔符**，默认为逗号。
9. 选择归档文件 **压缩格式**，默认为非压缩。
10. 选择归档文件 **大小上限**（文件压缩前的大小限制）。如果文件超出上限，系统将对文件进行切分存储。切分后的文件命名规则为`filename_UTC_n`，`n`为正整数，代表文件的编号。

.. note:: 归档存储策略一旦提交，文件类型、编码格式、列分隔符、压缩格式不可再修改。

### 归档配置

选择归档存储策略的 **归档周期**，目前支持1小时、6小时、12小时、24小时归档周期选项。

选择较长的归档周期，可以有效减少因数据延迟产生的小文件数量。设置不同的归档周期，归档任务的计划开始时间不同，处理的数据区间也不同。每个归档周期，对应的归档数据范围，表示系统时间处于 “前一个归档周期的计划开始时间” 至 “当前归档周期的计划开始时间” 之间的数据。归档存储策略提交之后，归档周期不可再修改。

每个归档周期选项的计划开始时间，以及归档数据的范围，参见[归档周期说明](../reference/archive_storage)。



### 内容配置

1. 选择待归档数据的数据通道，目前仅支持**实时数据**通道归档存储。
2. 选择归档数据所属模型。单个模型只能配置一个归档存储策略。

以上配置完成之后，点击**确认**，提交归档存储策略。存储策略提交后，将立即生效。若当前周期的数据归档任务未完成，将自动按照新提交的策略重新运行。

.. note:: 归档策略一旦运行，不支持手动停止。若需停止归档，可删除相应的策略。策略删除后，已归档的文件不受影响。

<!--end-->
