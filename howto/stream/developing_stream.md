# 开发流数据处理任务
流数据处理任务开发流程如下：

1. 创建流数据处理任务
2. 配置流数据处理策略
3. 保存及发布流数据处理任务
4. 运行及维护流数据处理任务


## 创建流数据处理任务
使用EnOS流数据处理系统提供的数据处理模板，可快速创建流数据处理任务。创建任务可通过新建或者导入现有配置两种方式来完成。具体步骤如下：

1. 进入控制台，点击 **流数据处理 > 流开发**，点击任务列表上方的 **+** 图标。
2. 在 **添加流** 窗口中，选择 **新建** 流数据处理任务。
3. 从 **消息集成通道** 下拉菜单中，选择待处理的流数据类型。
   - 若数据为接入设备上送的数据，选择 **实时消息通道**
   - 若数据为通过消息集成模块导入的数据，选择 **离线消息通道**
4. 输入流数据处理任务的名称和描述。
5. 选择对应的流数据处理 **模板**。
6. 点击 **确认**，进入数据处理任务配置页面。

.. image:: ../media/create_stream.png

## 配置流数据处理策略
使用EnOS流数据处理系统提供的多种模板，可快速配置不同的流数据处理策略。支持的模板和模板功能如下：
- AI数据聚合处理模板：支持将单个设备上的某个AI测点数据进行聚合处理后赋值给同设备上的另一个AI测点。具体请参考[AI数据聚合处理模板](../learn/ai_template_overview)。
- 多路数据归并处理模板：支持同一模型下，单个设备上多个测点间的表达式运算处理。具体请参考[多路数据归并处理模板](../learn/multi_point_overview)。
- 电量计算模板：支持对电表上送的数据，通过特定的运算方法配置，计算出某个计算周期内的总电量或特定时间区间内的电量。具体请参考[电量计算模板](../learn/pi_template_overview.html)。



## 保存及发布流数据处理任务

流数据处理策略配置完成之后，可对流数据处理任务进行其它操作，比如保存、告警配置、恢复为线上版本、导出配置、发布。
- **保存**：编辑完流数据处理策略后，点击**保存**。只有保存后的任务才能进行发布操作。
- **导出配置**：若需要重复使用流数据处理任务配置，点击**导出配置**，下载出当前任务的配置信息。在创建其它任务时，可直接导入保存的配置文件。
- **恢复为线上版本**：对现有流数据处理任务进行编辑之后，如果对编辑后的内容不满意，可点击**恢复为线上版本**，一键恢复为线上版本的配置信息。
- **告警配置**：点击**告警配置**，对流数据处理任务配置告警规则。目前告警配置支持对任务进行邮件或短信告警，当任务运行出现问题时，能通过邮件或短信通知任务负责人。
- **发布**：编辑并保存流数据处理任务之后，点击**发布**，将任务发布上线。发布前需保证该任务在线上无正在运行的实例。如有正在运行的实例，需在**流运维**页面暂停运行中的任务后再发布更新后的配置。

.. image:: ../media/config_stream.png

流数据处理任务发布之后，可在**流运维**页面启动任务。启动任务之前，需确保组织已分配流数据处理资源。如需申请资源，请参考[资源申请及扩容](/docs/enos/zh_CN/latest/resourcemanagement/getstarted.html)。
