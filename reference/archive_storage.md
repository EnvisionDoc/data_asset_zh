# 归档存储参考说明

## 数据归档方式
对于设备采集数据以及流数据处理之后生成的数据，支持按数据的事件时间或系统时间生成归档文件。生成的归档文件将根据存储路径信息，自动同步到指定的存储系统中。设置存储路径时，选择按事件时间或系统时间生成目录，来确定生成文件的方式。

设置存储路径时，若选择按事件时间生成目录，将对数据的内容进行解析并获取数据的事件时间。然后将位于同一个时间分区下的数据，写入到一个文件中。最后将生成的归档文件同步到对应的目录中。若选择按系统时间生成目录，将根据数据的系统时间戳，将位于同一个时间分区下的数据，写入到一个文件中。最后将生成的归档文件同步到对应的目录中。

## 存储路径分区参数
填写归档文件存储的根目录，并选择分目录方式后，还可以选择不同的时间分区参数格式。目前支持四种时间分区参数格式，具体说明如下。

.. list-table::
   :widths: 20 30 50

   * - 参数格式
     - 说明
     - 示例
   * - YYYYMMDD
     - 按天分目录
     - /bucketName/samplePath/20190101/
   * - YYYYMMDD/HH
     - 按天/小时分目录
     - /bucketName/samplePath/20190101/00/
   * - YYYY/MM/DD
     - 按年/月/天分目录
     - /bucketName/samplePath/2019/01/01/
   * - YYYY/MM/DD/HH
     - 按年/月/天/小时分目录
     - /bucketName/samplePath/2019/01/01/00/

## 归档周期说明
归档周期，决定了触发数据归档任务的时间间隔。归档周期越长，周期内可处理的数据量越大。

当前，归档存储策略支持的归档周期为1小时，6小时，12小时及24小时。不同的归档周期，触发归档任务的计划开始时间不同，归档的数据范围也不同，举例说明如下。

.. list-table::
   :widths: 20 40 40

   * - 归档周期
     - 任务计划开始时间
     - 归档数据范围
   * - 1小时
     - 00:00:00, 01:00:00, 02:00:00, ..., 23:00:00
     - 以01:00:00为例，归档数据区间为[00:00:00, 01:00:00)
   * - 6小时
     - 00:00:00, 06:00:00, 12:00:00, 18:00:00
     - 以06:00:00为例，归档数据区间为[00:00:00, 06:00:00)
   * - 12小时
     - 00:00:00, 12:00:00
     - 以12:00:00为例，归档数据区间为[00:00:00, 12:00:00)
   * - 24小时
     - 00:00:00
     - 以2019-01-02 00:00:00为例，归档数据区间为[2019-01-01 00:00:00, 2019-01-02 00:00:00)

.. note:: 归档数据区间的范围，以数据的系统时间戳为准。若数据系统时间戳位于当前归档数据区间内，将按照策略配置被归档，并被同步到相应的目录分区中。
